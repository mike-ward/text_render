# Requirements Archive: v1.2 Performance Optimization

**Archived:** 2026-02-02
**Status:** SHIPPED

This is the archived requirements specification for v1.2.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## v1.2 Requirements

Requirements for performance optimization milestone.

### Instrumentation

- [x] **INST-01**: Profiling builds with `-d profile` flag have zero release overhead
- [x] **INST-02**: Frame time breakdown shows layout/rasterize/upload/draw phases
- [x] **INST-03**: Cache hit/miss rates tracked for glyph, metrics, and layout caches
- [x] **INST-04**: Memory allocation tracking shows peak usage and growth rate
- [x] **INST-05**: Atlas utilization metrics show used/total pixels per page

### Latency

- [x] **LATENCY-01**: Multi-page atlas eliminates mid-frame reset stalls
- [x] **LATENCY-02**: FreeType metrics cached by (font, size) tuple
- [x] **LATENCY-03**: Glyph cache validates hash collisions with secondary key
- [x] **LATENCY-04**: Color emoji scaling uses GPU or cached scaled bitmaps

### Memory

- [x] **MEM-01**: Glyph cache uses LRU eviction with configurable max entries

## Future Requirements (Deferred)

Deferred to post-v1.2.

### Atlas Optimization

- **ATLAS-01**: Shelf packing allocator for better atlas utilization
- **ATLAS-02**: Async texture updates to eliminate glTexSubImage stalls
- **ATLAS-03**: Workload separation (glyphs vs images)

### Additional Caching

- **CACHE-01**: Shape plan caching for HarfBuzz overhead reduction

## Out of Scope

| Feature | Reason |
|---------|--------|
| Vector texture rendering | Harder on GPU than bitmap atlas, VGlyph uses FreeType |
| Thread pool rasterization | V is single-threaded by design |
| SDF (Signed Distance Fields) | Quality feature, not performance; GPU cost higher |
| Pre-rendered atlases | App size bloat, character set unknown at build |
| Custom memory allocator | Premature; VGlyph has overflow validation |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| INST-01 | Phase 8 | Complete |
| INST-02 | Phase 8 | Complete |
| INST-03 | Phase 8 | Complete |
| INST-04 | Phase 8 | Complete |
| INST-05 | Phase 8 | Complete |
| LATENCY-01 | Phase 9 | Complete |
| LATENCY-02 | Phase 9 | Complete |
| LATENCY-03 | Phase 9 | Complete |
| LATENCY-04 | Phase 9 | Complete |
| MEM-01 | Phase 10 | Complete |

**Coverage:**
- v1.2 requirements: 10 total
- Mapped to phases: 10
- Shipped: 10

---

## Milestone Summary

**Shipped:** 10 of 10 v1.2 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-02 as part of v1.2 milestone completion*
